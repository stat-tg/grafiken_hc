<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/modules/exporting.js"></script>
    <script src="https://code.highcharts.com/modules/export-data.js"></script>
	<script src="https://highcharts.github.io/export-csv/export-csv.js"></script>
    <script src="https://code.highcharts.com/modules/data.js"></script>
</head>

<center> 
    <div id="AltersPyramide" style="height: 800px; max-width: 800px;"></div>
</center>

<script>
      $(document).ready(function() {
        var chart = {
          type: 'bar'
        };
        var plotOptions = {
        	series: {
            	stacking: 'normal'
        	}
    	};
        var title = {
          text: 'Immer mehr ältere Menschen',
          style: {
            fontSize: '18px',
          },
          align: 'left'
        };
        var subtitle = {
          text: 'Kanton Thurgau, 2016, in 1000 Personen',
          style: {
            fontSize: '12px'
          },
          align: 'left'
        };
        var xAxis = [{
          reversed: false,
          categories: ['0-4','5-9','10-14','15-19','20-24','25-29','30-34','35-39','40-44','45-49','50-54','55-59','60-64','65-69','70-74','75-79','80-84','85-89','90+']
        },{
          opposite: true,
          reversed: false,
          categories: ['0-4','5-9','10-14','15-19','20-24','25-29','30-34','35-39','40-44','45-49','50-54','55-59','60-64','65-69','70-74','75-79','80-84','85-89','90+'],
          linkedTo: 0
        }];
        var yAxis = {
          tickInterval: 2000,
          lineWidth: 1,
          gridLineWidth: 1,
          title: '',
          reversedStacks: true,
          labels: {
          	formatter: function () {
          		return (Highcharts.numberFormat(Math.abs(this.value),0));
          	}
   }
        };
        var legend = {
          layout: 'horizontal',
          align: 'center',
          verticalAlign: 'bottom',
          padding: 25,
          symbolPadding: 10,
          symbolWidth: 25,
          margin: -10,
          itemStyle: {
            fontWeight: 'normal'
          }
        };
        var series = [{
          name: 'Ausländische Männer',
          color: '#878787',
          data: [-1690,-1718,-1576,-1548,-1845,-2879,-3619,-3535,-3054,-3318,-3175,-2255,-1463,-957,-736,-646,-267,-105,-24]
        },{
          name: 'Männer',
          color: '#27408B',
          data: [-5335,-5200,-5067,-6120,-6790,-6353,-5784,-5246,-5822,-7454,-8392,-7655,-6618,-5929,-4601,-3077,-2244,-1289,-522]
        },{
          name: 'Ausländische Frauen',
          color: '#B5B5B5',
          data: [1650,1574,1584,1453,1709,2710,3091,2969,2656,2758,2443,1629,1071,718,566,519,222,112,40]
        },{
          name: 'Frauen',
          color: '#0064e6',
          data: [4807,4942,4821,5627,6469,6145,5595,5313,6046,8061,8711,7791,6684,6095,5126,3970,3266,2291,1368]
        }];
        var credits = {
          text: 'Dienststelle für Statistik Kanton Thurgau <br>Datenquelle: BFS',
          href: false,
          position: {
            align: 'left',
            x: 10,
            y: -20
          }
        };
        var exporting = {
          allowHTML: true,
          enabled: true,
          filename:'AltersPyramide',
          buttons: {
            contextButton: {
              menuItems: "printChart separator downloadPNG downloadJPEG downloadSVG".split(" ")
            }
          },
          /*csv: {
            columnHeaderFormatter: function (item) {
              if(item instanceof Highcharts.Axis) {
                return 'Kategorie';
              } else {
                if(item instanceof Highcharts.Series) {
                  return item.name;
                }
              }
            }
          }*/
        };
        var tooltip= {
          shadow: false,
          xDateFormat: '%B %Y',
          formatter: function() {
      		return '<b>'+ this.series.name +'</b><br/>'+
         	this.x +': '+ Highcharts.numberFormat(Math.abs(this.y),0) +' Personen';
    	  }
        };
        var highchartsOptions = Highcharts.setOptions ({
        	lang: {
        		decimalPoint: '.',
           	 	thousandsSep: "'",
           	 	months: ['Januar', 'Februar', 'März', 'April', 'Mai', 'Juni', 'Juli', 'August', 'September', 'Oktober', 'November', 'Dezember'],
            	weekdays: ['Sonntag', 'Montag', 'Dienstag', 'Mittwoch', 'Donnerstag', 'Freitag', 'Samstag'],
            	shortMonths: ['Jan', 'Feb', 'Mrz', 'Apr', 'Mai', 'Jun', 'Jul', 'Aug', 'Sep', 'Okt', 'Nov', 'Dez'],
            	contextButtonTitle: 'Drucken, Download, Export',
            	downloadJPEG: 'Download JPEG Bild',
            	downloadPNG: 'Download PNG Bild',
            	downloadSVG: 'Download SVG Vektor Bild',
            	downloadXLS: 'Download XLS',
            	printChart: 'Bild drucken',
            	viewData: 'Datentabelle ein-/ausblenden',
            	resetZoom: "Zoom zurücksetzen",
            	resetZoomTitle: "Zoom zurücksetzen",
            	drillUpText: "Zurück"
        	}        
		});
            
        var json = {};
        json.chart = chart;
        json.plotOptions = plotOptions;
        json.title = title;
        json.subtitle = subtitle;
        json.xAxis = xAxis;
        json.yAxis = yAxis;
        json.legend = legend;
        json.series = series;
        json.credits = credits;
        json.exporting = exporting;
        json.tooltip = tooltip;
        json.highchartsOptions = highchartsOptions;
        
        $('#AltersPyramide').highcharts(json);
      });
</script>

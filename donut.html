<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>
<script src="https://code.highcharts.com/modules/export-data.js"></script>
<script src="https://highcharts.github.io/export-csv/export-csv.js"></script>
<script src="https://code.highcharts.com/modules/data.js"></script>
<script src="https://blacklabel.github.io/grouped_categories/grouped-categories.js"></script>
<script src="https://code.highcharts.com/modules/drilldown.js"></script>

<center>
<div id="2020_10_Migrationsstatus_2015_2017" style="height: 600px; max-width: 800px;"></div>
</center>

	<script>
		$(document).ready(function() {
 			 var outer = [{
    			"name": "Ausländer/-innen 1. Generation",
    			"data": [
      				['Ausländer/-innen 1. Generation',21.1]
    				]
  				}, {
    			"name": "Ausländer/-innen 2. Generation",
    			"data": [
      				['Ausländer/-innen 2. Generation',3.2]
    			]
             	}, {
    			"name": "Schweizerbürger mit<br>Migrationshintergrund",
    			"data": [
      				['Schweizerbürger mit<br>Migrationshintergrund',11.4]
                    ]
  				}, {
    			"name": "Bevölkerung mit nicht <br>bestimmbarem Migrationsstatus",
    			"data": [
      				['Bevölkerung mit nicht <br>bestimmbarem Migrationsstatus',0.5]
                    ]
  				}, {
    			"name": "Bevölkerung ohne <br>Migrationshintergrund",
    			"data": [
      				['Bevölkerung ohne <br>Migrationshintergrund',63.8]
    				]
  				
  			}];

  			var inner = [{
    			"name": "Bevölkerung mit<br> Migrationshintergrund",
    			"y": 35.7,
    			"color":"#87ceff"
  			}, {
    			"name": "Bevölkerung <br>ohne Migrations-<br>hintergrund",
    			"y": 63.8,
    			"color": "#a2c510"
  			}];

  			var outerData = [];

  			$.each(outer, function(i, item) {
    			outerData.push({
      			name: item.data[0][0],
      			y: item.data[0][1],
    		});

  			});



  			var chart = {
    			type: 'pie',
    			spacingBottom: 30
  			};
  			
             var plotOptions = {
            pie: {
                point: {
            		events: {
                		legendItemClick: function () {
                    return false; 
               			}
            		}
    			},
    			allowPointSelect: false,
               // borderWidth: 0
            }
        };
            
 			var title = {
                text: 'Gutes Drittel der Bevölkerung mit Migrationshintergrund',
                style: {
                    fontSize: '18px'
                },
                align: 'left'
            };
            
            var subtitle = {
                text: 'Bevölkerung ab 15 Jahren nach Migrationsstatus, Kanton Thurgau, 2015/2017, Anteile in %',
                style: {
                    fontSize: '12px'
                },
                align: 'left'
            };
            
  			var series = [{
    			name: '',
    			colorByPoint: false,
    			data: inner,
    			size: '60%',
    			dataLabels: {
    				enabled: true,
        			distance: -45,
        			color: '#333333',
        			shadow: false
        			},
    			showInLegend: false
  			}, {
    			name:'',
    			colorByPoint: true,
    			data: outerData,
    			size: '90%',
    			innerSize: '60%',
    			dataLabels: {
      				enabled: false
    				},
    			showInLegend: true
  			}];

  			var tooltip = {
    			enabled: true,
                headerFormat: "<span style='font-size: 12px'>{point.key}: <b>{point.y:.0f}</b> %<br/></span><br/>",
                pointFormat: ""

  			};
            
  			var legend = {
    			layout: 'horizontal',
    			align: 'center',
    			verticalAlign: 'bottom',
    			padding: 25,
    			itemDistance: 5,
    			symbolPadding: 5,
    			symbolWidth: 20,
    			margin: -10,
    			itemStyle: {
      				fontWeight: 'normal'
    			}
  			};

  			var credits = {
    			text: 'Dienststelle für Statistik Kanton Thurgau <br>Datenquelle: Bundesamt für Statistik, Strukturerhebung',
    			href: false,
    			style: {
      				cursor: false,
      				fontSize: '10px'
    				},
    			position: {
      			align: 'left',
      			x: 10,
      			y: -30
    			}
  			};
  
  			var exporting = {
    			allowHTML: true,
    			enabled: true,
    			filename: '2020_10_Migrationsstatus_2015_2017',
    			buttons: {
      				contextButton: {
        				menuItems: "printChart separator downloadPNG downloadJPEG downloadSVG separator downloadXLS".split(" ")
      				}
    			},
    			csv: {
      				columnHeaderFormatter: function(item) {
        			if (item instanceof Highcharts.Axis) {
          			return 'Kategorie';
        			} else {
          			if (item instanceof Highcharts.Series) {
            		return item.name;
          			}
        		  }
      		    }
    		  }
  			};
            
  			var highchartsOptions = Highcharts.setOptions ({
        		lang: {
        			decimalPoint: '.',
           		 	thousandsSep: "'",
           		 	months: ['Januar', 'Februar', 'März', 'April', 'Mai', 'Juni', 'Juli', 'August', 'September', 'Oktober', 'November', 'Dezember'],
            		weekdays: ['Sonntag', 'Montag', 'Dienstag', 'Mittwoch', 'Donnerstag', 'Freitag', 'Samstag'],
            		shortMonths: ['Jan', 'Feb', 'Mrz', 'Apr', 'Mai', 'Jun', 'Jul', 'Aug', 'Sep', 'Okt', 'Nov', 'Dez'],
            		contextButtonTitle: 'Drucken, Download, Export',
            		downloadJPEG: 'Download JPEG Bild',
            		downloadPNG: 'Download PNG Bild',
            		downloadSVG: 'Download SVG Vektor Bild',
            		downloadXLS: 'Download XLS',
            		printChart: 'Bild drucken',
            		viewData: 'Datentabelle ein-/ausblenden',
            		resetZoom: "Zoom zurücksetzen",
            		resetZoomTitle: "Zoom zurücksetzen",
            		drillUpText: "Zurück"
        		}        
			});
            
 			var colors = ['#27408B','#0064e6','#00B4E8','#878787','#a2c510','#FFED00','#E39E00','#CD3700','#8B0000','#B5B5B5','#878787','#333333']


  			var json = {};
  			json.chart = chart;
  			json.plotOptions = plotOptions;
  			json.title = title;
  			json.subtitle = subtitle;
  			json.series = series;
  			json.tooltip = tooltip;
  			json.legend = legend;
  			json.credits = credits;
  			json.exporting = exporting;
  			json.highchartsOptions = highchartsOptions;
 			json.colors = colors;
  			$('#2020_10_Migrationsstatus_2015_2017').highcharts(json);
		});
</script>

